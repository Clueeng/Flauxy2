package uwu.noctura.module.impl.exploit;

import net.minecraft.network.play.client.C01PacketChatMessage;
import uwu.noctura.event.Event;
import uwu.noctura.event.impl.EventSendPacket;
import uwu.noctura.module.Category;
import uwu.noctura.module.Module;
import uwu.noctura.module.ModuleInfo;
import uwu.noctura.utils.PacketUtil;
import uwu.noctura.utils.WorldUtil;
import uwu.noctura.utils.Wrapper;

@ModuleInfo(name = "ChatBypass", displayName = "Chat Bypass", key = -1, cat = Category.Exploit)
public class ChatBypass extends Module {

    @Override
    public void onEvent(Event e) {
        if(e instanceof EventSendPacket){

            if(WorldUtil.shouldNotRun()) return;
            EventSendPacket event = (EventSendPacket) e;
            if(event.getPacket() instanceof C01PacketChatMessage){
                Wrapper.instance.log("Sent");
                C01PacketChatMessage packet = event.getPacket();
               if(packet.getMessage().startsWith("/") || packet.getMessage().startsWith(".")){

               }else{
                   String oldMessage = packet.getMessage();

                   String newMessage = oldMessage;
                   newMessage = oldMessage.replaceAll("a", "â").replaceAll("A", "â").replaceAll("i", "ì")
                           .replaceAll("I", "ì").replaceAll("e", "ě").replaceAll("E", "ě")
                           .replaceAll("z","ž").replaceAll("U","Ü").replaceAll("D","Ð").replaceAll("d","Ð")
                           .replaceAll("y","ÿ").replaceAll("n","ñ").replaceAll("k", "к").replaceAll("g","ǥ")
                           .replaceAll("G","ǥ").replaceAll("b", "ь").replaceAll("B","в").replaceAll("p","р")
                           .replaceAll("f","ƒ");
                   event.setCancelled(true);
                   PacketUtil.packetNoEvent(new C01PacketChatMessage(newMessage));
               }
            }
        }
    }
}
